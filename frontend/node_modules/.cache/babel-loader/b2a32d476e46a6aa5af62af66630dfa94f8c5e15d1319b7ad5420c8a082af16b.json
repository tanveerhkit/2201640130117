{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.initLogger = initLogger;\nexports.Log = Log;\nexports.expressLogger = expressLogger;\nconst client_1 = require(\"./client\");\nlet defaultClient = null;\nfunction initLogger(cfg) {\n  defaultClient = new client_1.LoggingClient(cfg);\n  return defaultClient;\n}\nasync function Log(stack, level, pkg, message) {\n  if (!defaultClient) {\n    defaultClient = new client_1.LoggingClient();\n  }\n  const payload = {\n    stack,\n    level,\n    package: pkg,\n    message\n  };\n  await defaultClient.log(payload);\n}\n// Express request logging middleware (optional convenience)\n// Logs request start and completion with status and duration.\nfunction expressLogger(opts) {\n  var _a, _b;\n  const stack = (_a = opts === null || opts === void 0 ? void 0 : opts.stack) !== null && _a !== void 0 ? _a : \"backend\";\n  const pkg = (_b = opts === null || opts === void 0 ? void 0 : opts.pkg) !== null && _b !== void 0 ? _b : \"middleware\";\n  return function (req, res, next) {\n    const start = Date.now();\n    const method = req.method;\n    const path = req.originalUrl || req.url;\n    Log(stack, \"info\", pkg, \"req start \".concat(method, \" \").concat(path));\n    res.on(\"finish\", () => {\n      const ms = Date.now() - start;\n      Log(stack, \"info\", pkg, \"req done \".concat(method, \" \").concat(path, \" \").concat(res.statusCode, \" \").concat(ms, \"ms\"));\n    });\n    next();\n  };\n}","map":{"version":3,"names":["Object","defineProperty","exports","value","initLogger","Log","expressLogger","client_1","require","defaultClient","cfg","LoggingClient","stack","level","pkg","message","payload","package","log","opts","_a","_b","req","res","next","start","Date","now","method","path","originalUrl","url","concat","on","ms","statusCode"],"sources":["/Users/naushadvali/Desktop/tanveer/logging-middleware/dist/index.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.initLogger = initLogger;\nexports.Log = Log;\nexports.expressLogger = expressLogger;\nconst client_1 = require(\"./client\");\nlet defaultClient = null;\nfunction initLogger(cfg) {\n    defaultClient = new client_1.LoggingClient(cfg);\n    return defaultClient;\n}\nasync function Log(stack, level, pkg, message) {\n    if (!defaultClient) {\n        defaultClient = new client_1.LoggingClient();\n    }\n    const payload = { stack, level, package: pkg, message };\n    await defaultClient.log(payload);\n}\n// Express request logging middleware (optional convenience)\n// Logs request start and completion with status and duration.\nfunction expressLogger(opts) {\n    var _a, _b;\n    const stack = (_a = opts === null || opts === void 0 ? void 0 : opts.stack) !== null && _a !== void 0 ? _a : \"backend\";\n    const pkg = (_b = opts === null || opts === void 0 ? void 0 : opts.pkg) !== null && _b !== void 0 ? _b : \"middleware\";\n    return function (req, res, next) {\n        const start = Date.now();\n        const method = req.method;\n        const path = req.originalUrl || req.url;\n        Log(stack, \"info\", pkg, `req start ${method} ${path}`);\n        res.on(\"finish\", () => {\n            const ms = Date.now() - start;\n            Log(stack, \"info\", pkg, `req done ${method} ${path} ${res.statusCode} ${ms}ms`);\n        });\n        next();\n    };\n}\n"],"mappings":"AAAA,YAAY;;AACZA,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAAEC,KAAK,EAAE;AAAK,CAAC,CAAC;AAC7DD,OAAO,CAACE,UAAU,GAAGA,UAAU;AAC/BF,OAAO,CAACG,GAAG,GAAGA,GAAG;AACjBH,OAAO,CAACI,aAAa,GAAGA,aAAa;AACrC,MAAMC,QAAQ,GAAGC,OAAO,CAAC,UAAU,CAAC;AACpC,IAAIC,aAAa,GAAG,IAAI;AACxB,SAASL,UAAUA,CAACM,GAAG,EAAE;EACrBD,aAAa,GAAG,IAAIF,QAAQ,CAACI,aAAa,CAACD,GAAG,CAAC;EAC/C,OAAOD,aAAa;AACxB;AACA,eAAeJ,GAAGA,CAACO,KAAK,EAAEC,KAAK,EAAEC,GAAG,EAAEC,OAAO,EAAE;EAC3C,IAAI,CAACN,aAAa,EAAE;IAChBA,aAAa,GAAG,IAAIF,QAAQ,CAACI,aAAa,CAAC,CAAC;EAChD;EACA,MAAMK,OAAO,GAAG;IAAEJ,KAAK;IAAEC,KAAK;IAAEI,OAAO,EAAEH,GAAG;IAAEC;EAAQ,CAAC;EACvD,MAAMN,aAAa,CAACS,GAAG,CAACF,OAAO,CAAC;AACpC;AACA;AACA;AACA,SAASV,aAAaA,CAACa,IAAI,EAAE;EACzB,IAAIC,EAAE,EAAEC,EAAE;EACV,MAAMT,KAAK,GAAG,CAACQ,EAAE,GAAGD,IAAI,KAAK,IAAI,IAAIA,IAAI,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,IAAI,CAACP,KAAK,MAAM,IAAI,IAAIQ,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAG,SAAS;EACtH,MAAMN,GAAG,GAAG,CAACO,EAAE,GAAGF,IAAI,KAAK,IAAI,IAAIA,IAAI,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,IAAI,CAACL,GAAG,MAAM,IAAI,IAAIO,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAG,YAAY;EACrH,OAAO,UAAUC,GAAG,EAAEC,GAAG,EAAEC,IAAI,EAAE;IAC7B,MAAMC,KAAK,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC;IACxB,MAAMC,MAAM,GAAGN,GAAG,CAACM,MAAM;IACzB,MAAMC,IAAI,GAAGP,GAAG,CAACQ,WAAW,IAAIR,GAAG,CAACS,GAAG;IACvC1B,GAAG,CAACO,KAAK,EAAE,MAAM,EAAEE,GAAG,eAAAkB,MAAA,CAAeJ,MAAM,OAAAI,MAAA,CAAIH,IAAI,CAAE,CAAC;IACtDN,GAAG,CAACU,EAAE,CAAC,QAAQ,EAAE,MAAM;MACnB,MAAMC,EAAE,GAAGR,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGF,KAAK;MAC7BpB,GAAG,CAACO,KAAK,EAAE,MAAM,EAAEE,GAAG,cAAAkB,MAAA,CAAcJ,MAAM,OAAAI,MAAA,CAAIH,IAAI,OAAAG,MAAA,CAAIT,GAAG,CAACY,UAAU,OAAAH,MAAA,CAAIE,EAAE,OAAI,CAAC;IACnF,CAAC,CAAC;IACFV,IAAI,CAAC,CAAC;EACV,CAAC;AACL","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}